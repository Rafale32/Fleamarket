<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="com.fleamarket.mapper.MainDetailMapper">
	<cache />


	<!-- <insert id="insertBoard" parameterType="Board"> insert into board( 
		seq, title, writer, contents, regdate, hitcount, fname )values( board_seq.nextval, 
		#{title},#{writer},#{contents},sysdate,0,#{fname} ) </insert> -->

	<select id="recommend" resultType="RecommendDTO">
		select distinct a.item_no,
		b.title, a.price, b.itemboard_date, a.delivery_fee, c.thum_img
		from
		item a, itemboard b, itemimg c
		where a.item_no=b.item_no
		and
		b.itemboard_no=c.itemboard_no
		and b.recommend_ornot=1
	</select>

	<select id="hotItemList" resultType="HotItemDTO">
		<![CDATA[
		select category_title, sub_title, thum_img, title, price, itemboard_date, delivery_fee, hits, ranking
		from(select a.category_title, b.sub_title, e.thum_img,
		d.title, c.price, d.itemboard_date, c.delivery_fee, d.hits,
		rank() over(partition by a.category_title order by hits desc)as ranking
		from category a, category_sub b, item c, itemboard d, itemimg e
		where a.category_no = b.category_no
		and b.sub_no = d.sub_no
		and c.item_no = d.item_no
		and d.itemboard_no = e.itemboard_no
		group by a.category_title, b.sub_title, e.thum_img,
		d.title, c.price, d.itemboard_date, c.delivery_fee, d.hits)
		where ranking <= 10
		]]>
	</select>
	
	<select id="categoryList" resultType="CategoryDTO">
		select category_no, category_title
    from category
    order by category_no	
	</select>

</mapper>
